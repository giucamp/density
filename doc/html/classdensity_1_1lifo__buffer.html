<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>density: lifo_buffer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">density
   </div>
   <div id="projectbrief">C++11 library for paged memory management, function queues, heterogeneous queues and lifo memory management</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacedensity.html">density</a></li><li class="navelem"><a class="el" href="classdensity_1_1lifo__buffer.html">lifo_buffer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="classdensity_1_1lifo__buffer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">lifo_buffer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="lifo_8h_source.html">lifo.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac602c49aeea021e5c1debf467a4d100d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdensity_1_1lifo__buffer.html#ac602c49aeea021e5c1debf467a4d100d">lifo_buffer</a> () noexcept</td></tr>
<tr class="separator:ac602c49aeea021e5c1debf467a4d100d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a359d73a6e395ae68d98d57d17a2f8c44"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdensity_1_1lifo__buffer.html#a359d73a6e395ae68d98d57d17a2f8c44">lifo_buffer</a> (size_t i_size)</td></tr>
<tr class="separator:a359d73a6e395ae68d98d57d17a2f8c44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1423e7826efe5d5166fd9d8e34b5c18"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdensity_1_1lifo__buffer.html#af1423e7826efe5d5166fd9d8e34b5c18">lifo_buffer</a> (const <a class="el" href="classdensity_1_1lifo__buffer.html">lifo_buffer</a> &amp;)=delete</td></tr>
<tr class="separator:af1423e7826efe5d5166fd9d8e34b5c18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9aab801464aaede0b37900ed4c074cd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdensity_1_1lifo__buffer.html">lifo_buffer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdensity_1_1lifo__buffer.html#af9aab801464aaede0b37900ed4c074cd">operator=</a> (const <a class="el" href="classdensity_1_1lifo__buffer.html">lifo_buffer</a> &amp;)=delete</td></tr>
<tr class="separator:af9aab801464aaede0b37900ed4c074cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a887c9c425b3a5a836c1ff662875711e2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdensity_1_1lifo__buffer.html#a887c9c425b3a5a836c1ff662875711e2">~lifo_buffer</a> ()</td></tr>
<tr class="separator:a887c9c425b3a5a836c1ff662875711e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a8503ab246153dde663abc4577a8421"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdensity_1_1lifo__buffer.html#a6a8503ab246153dde663abc4577a8421">resize</a> (size_t i_new_size)</td></tr>
<tr class="separator:a6a8503ab246153dde663abc4577a8421"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3479e2ef35bb06eba5dca81e2d8ff2d2"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdensity_1_1lifo__buffer.html#a3479e2ef35bb06eba5dca81e2d8ff2d2">data</a> () const  noexcept</td></tr>
<tr class="separator:a3479e2ef35bb06eba5dca81e2d8ff2d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44545a936daa510da7f9fe4835f6ee84"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdensity_1_1lifo__buffer.html#a44545a936daa510da7f9fe4835f6ee84">size</a> () const  noexcept</td></tr>
<tr class="separator:a44545a936daa510da7f9fe4835f6ee84"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:ac15e6b5f88a94c672b70f8a914798517"><td class="memItemLeft" align="right" valign="top">static constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classdensity_1_1lifo__buffer.html#ac15e6b5f88a94c672b70f8a914798517">alignment</a> = detail::ThreadLifoAllocator&lt;&gt;::alignment</td></tr>
<tr class="separator:ac15e6b5f88a94c672b70f8a914798517"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class that allocates a memory block from the thread-local data stack, and owns it. The block is deallocated by the destructor. This class should be used only on the automatic storage.</p>
<p>The data stack is a pool in which a thread can allocate and deallocate memory in LIFO order. It is handled by an internal <a class="el" href="classdensity_1_1lifo__allocator.html">lifo_allocator</a>, which in turn in built upon an instance of <a class="el" href="namespacedensity.html#adeb11d97131a6de72c7b1d4b6c10f342">default_allocator</a>. <a class="el" href="classdensity_1_1lifo__array.html">lifo_array</a> and <a class="el" href="classdensity_1_1lifo__buffer.html">lifo_buffer</a> allocate on the data stack, so they must respect the LIFO order: only the most recently allocated block can be deallocated or reallocated. Instantiating <a class="el" href="classdensity_1_1lifo__array.html">lifo_array</a> and <a class="el" href="classdensity_1_1lifo__buffer.html">lifo_buffer</a> on the automatic storage (locally in a function) is always safe, as the language guarantees destruction in reverse order, even inside arrays or aggregate types.</p>
<p><a class="el" href="classdensity_1_1lifo__buffer.html">lifo_buffer</a> provides a low-level service, as it allocates untyped raw memory. It allows resizing preserving the content, but it does so memcpy'ng the content when the address of the block changes.</p>
<p>A thread may resize a <a class="el" href="classdensity_1_1lifo__buffer.html">lifo_buffer</a> only if it is the most recently instantiated <a class="el" href="classdensity_1_1lifo__buffer.html">lifo_buffer</a> or <a class="el" href="classdensity_1_1lifo__array.html">lifo_array</a>, otherwise the behavior is undefined.</p>
<div class="fragment"><div class="line">    <span class="comment">// concatenate and print a null terminated array of strings</span></div><div class="line">    <span class="keywordtype">void</span> concat_and_print(<span class="keyword">const</span> <span class="keywordtype">char</span> ** i_strings)</div><div class="line">    {</div><div class="line">        <span class="keyword">using namespace </span><a class="code" href="namespacedensity.html">density</a>;</div><div class="line"></div><div class="line">        <a class="code" href="classdensity_1_1lifo__buffer.html">lifo_buffer</a> buff;</div><div class="line">        <span class="keywordflow">while</span> (*i_strings != <span class="keyword">nullptr</span>)</div><div class="line">        {</div><div class="line">            <span class="keyword">auto</span> <span class="keyword">const</span> curr_len =</div><div class="line">              buff.<a class="code" href="classdensity_1_1lifo__buffer.html#a44545a936daa510da7f9fe4835f6ee84">size</a>() &gt; 0 ? buff.<a class="code" href="classdensity_1_1lifo__buffer.html#a44545a936daa510da7f9fe4835f6ee84">size</a>() - 1 : 0; <span class="comment">// discard the previous null char, if any</span></div><div class="line">            <span class="keyword">auto</span> <span class="keyword">const</span> additional_len = strlen(*i_strings);</div><div class="line"></div><div class="line">            buff.<a class="code" href="classdensity_1_1lifo__buffer.html#a6a8503ab246153dde663abc4577a8421">resize</a>(curr_len + additional_len + 1);</div><div class="line">            memcpy(static_cast&lt;char *&gt;(buff.<a class="code" href="classdensity_1_1lifo__buffer.html#a3479e2ef35bb06eba5dca81e2d8ff2d2">data</a>()) + curr_len, *i_strings, additional_len + 1);</div><div class="line"></div><div class="line">            i_strings++;</div><div class="line">        }</div><div class="line"></div><div class="line">        std::cout &lt;&lt; static_cast&lt;char *&gt;(buff.<a class="code" href="classdensity_1_1lifo__buffer.html#a3479e2ef35bb06eba5dca81e2d8ff2d2">data</a>()) &lt;&lt; std::endl;</div><div class="line">    }</div></div><!-- fragment --></div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ac602c49aeea021e5c1debf467a4d100d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdensity_1_1lifo__buffer.html">lifo_buffer</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Allocates an empty block. </p>

</div>
</div>
<a class="anchor" id="a359d73a6e395ae68d98d57d17a2f8c44"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdensity_1_1lifo__buffer.html">lifo_buffer</a> </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>i_size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Allocates the block </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i_size</td><td>size in bytes of the memory block. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af1423e7826efe5d5166fd9d8e34b5c18"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdensity_1_1lifo__buffer.html">lifo_buffer</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classdensity_1_1lifo__buffer.html">lifo_buffer</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Copy construction not allowed </p>

</div>
</div>
<a class="anchor" id="a887c9c425b3a5a836c1ff662875711e2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">~<a class="el" href="classdensity_1_1lifo__buffer.html">lifo_buffer</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Deallocates the block </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="af9aab801464aaede0b37900ed4c074cd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdensity_1_1lifo__buffer.html">lifo_buffer</a>&amp; operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classdensity_1_1lifo__buffer.html">lifo_buffer</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Copy assignment not allowed </p>

</div>
</div>
<a class="anchor" id="a6a8503ab246153dde663abc4577a8421"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void* resize </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>i_new_size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Changes the size of the block, preserving its existing content. If the buffer grows (the new size is bigger than the previous one) the new content has undefined content.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i_new_size</td><td>size in bytes of the memory block. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the new address of the block</dd></dl>
<p>This function may reallocate the block, so its address may change.</p>
<dl class="section pre"><dt>Precondition</dt><dd>The behavior is undefined if either:<ul>
<li>this block was not the most recently allocated one on the data stack of the calling thread</li>
</ul>
</dd></dl>
<p><br />
 <b>Exception guarantee</b>: strong (in case of exception the function has no observable effects). </p>

</div>
</div>
<a class="anchor" id="a3479e2ef35bb06eba5dca81e2d8ff2d2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void* data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the address of the owned memory block. If the block is empty (that is the size is zero), the return value is undefined (may be nullptr, or any address), but it's still aligned to <a class="el" href="classdensity_1_1lifo__buffer.html#ac15e6b5f88a94c672b70f8a914798517">alignment</a>. </p>

</div>
</div>
<a class="anchor" id="a44545a936daa510da7f9fe4835f6ee84"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the size of the owned memory block. </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="ac15e6b5f88a94c672b70f8a914798517"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr size_t alignment = detail::ThreadLifoAllocator&lt;&gt;::alignment</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Alignment guaranteed for the block </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>C:/projects/density/include/density/<a class="el" href="lifo_8h_source.html">lifo.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
